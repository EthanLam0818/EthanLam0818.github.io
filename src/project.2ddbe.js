window.__require=function e(t,o,n){function r(i,s){if(!o[i]){if(!t[i]){var l=i.split("/");if(l=l[l.length-1],!t[l]){var a="function"==typeof __require&&__require;if(!s&&a)return a(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+i+"'")}i=l}var p=o[i]={exports:{}};t[i][0].call(p.exports,function(e){return r(t[i][1][e]||e)},p,p.exports,e,t,o,n)}return o[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"849c4C0IldKmagY8j8aJUc3","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.getConf=function(e){for(var t=0;t<this.planeConf.length;t++){var o=this.planeConf[t];if(o.id==e)return o}},e.ScrowRadius=64,e.SucceDist=20,e.FirstTouch=!1,e.ReplayCount=0,e.OverTimer=30,e.planeConf=[{id:"plates_01",slotCount:2,slotPoint:[new cc.Vec2(-110,0),new cc.Vec2(110,0)]},{id:"plates_02",slotCount:2,slotPoint:[new cc.Vec2(-110,40),new cc.Vec2(110,40)]},{id:"plates_03",slotCount:2,slotPoint:[new cc.Vec2(-85,115),new cc.Vec2(-85,-125)]},{id:"circle",slotCount:1,slotPoint:[cc.Vec2.ZERO]},{id:"plates_04",slotCount:2,slotPoint:[new cc.Vec2(-100,0),new cc.Vec2(120,0)]},{id:"plates_05",slotCount:2,slotPoint:[new cc.Vec2(-100,0),new cc.Vec2(145,0)]},{id:"plates_lv2_r1",slotCount:1,slotPoint:[new cc.Vec2(0,100)]},{id:"plates_lv2_r2",slotCount:3,slotPoint:[new cc.Vec2(0,220),cc.Vec2.ZERO,new cc.Vec2(0,-210)]}],e.handConf=[{position:new cc.Vec3(73,200),angle:-43},{position:new cc.Vec3(0,22),angle:0}],e}();o.default=n,cc._RF.pop()},{}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"faf97jQ/FJFBo+2A99MfTX4","GameManager");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,c=arguments.length,i=c<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(c<3?r(i):c>3?r(t,o,i):r(t,o))||i);return c>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./GameConfig"),i=cc._decorator,s=i.ccclass,l=i.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slotRootNode=null,t.platesRootNode=null,t.replayBtnNode=null,t._slotArr=[],t._platesArr=[],t.handNode=null,t._isTweening=!1,t._currSlot=null,t._currScrowNode=null,t._resetScrowNode=null,t._isPlay_ScrewTween=!1,t._ovlerps=[],t}return n(t,e),t.prototype.onLoad=function(){var e=this;this._physicManager=cc.director.getPhysicsManager(),this._physicManager.enabled=!0,this._physicManager.enabledAccumulator=!0,cc.PhysicsManager.FIXED_TIME_STEP=1/60,cc.PhysicsManager.VELOCITY_ITERATIONS=10,cc.PhysicsManager.POSITION_ITERATIONS=10,this.slotRootNode.children.forEach(function(t){t.name.includes("slot"),e._slotArr.push(t)}),this.platesRootNode.children.forEach(function(t){e._platesArr.push(t)}),this._slotArr.forEach(function(t){t.on(cc.Node.EventType.TOUCH_START,e.touchStart,e)}),this._handeTween=cc.tween().to(0,{position:c.default.handConf[0].position,angle:c.default.handConf[0].angle}).to(.5,{opacity:255}).to(1,{position:c.default.handConf[1].position,angle:c.default.handConf[1].angle}).to(.5,{opacity:0}).call(function(){0==c.default.FirstTouch&&e._handeTween.clone(e.handNode).start()}),0==c.default.FirstTouch?this._handeTween.clone(this.handNode).start():this.handNode.active=!1,this.replayBtnNode.on(cc.Node.EventType.TOUCH_START,this.replay,this)},t.prototype.touchStart=function(e){if(1!=this._isPlay_ScrewTween&&(this._currSlot=e.getCurrentTarget(),console.log("slelect",e.getCurrentTarget().name),0==c.default.FirstTouch&&(c.default.FirstTouch=!0,this.handNode.active=!1),this._currSlot.children[0]!==this._resetScrowNode))if(0!=this._currSlot.childrenCount){if(null!=this._currScrowNode&&(this.resetSrow(this._currScrowNode),this._currScrowNode=this._currSlot.children[0]))return void(this._currScrowNode=null);this.selectSrow(this._currSlot.children[0])}else if(null!=this._currScrowNode){if(0==this.checkOvlerp(this._currSlot))return;this.moveSrow(this._currScrowNode)}},t.prototype.selectSrow=function(e){var t=this;this._currScrowNode=e,e.parent.zIndex=1e4,e.getComponent(cc.Sprite).spriteFrame=this.screw_select_sprite,this._isPlay_ScrewTween=!0,cc.tween(this._currScrowNode).to(.2,{position:new cc.Vec3(0,150,0)},{easing:"smooth"}).call(function(){return t._isPlay_ScrewTween=!1}).start()},t.prototype.resetSrow=function(e){var t=this;this._resetScrowNode=e,cc.tween(this._resetScrowNode).to(.2,{position:cc.Vec3.ZERO},{easing:"smooth"}).call(function(){e.parent.zIndex=-e.parent.position.y,t._resetScrowNode.getComponent(cc.Sprite).spriteFrame=t.screw_idle_sprite,t._resetScrowNode=null}).start()},t.prototype.moveSrow=function(e){var t=this;e.parent.zIndex=1e4;var o=e.parent.convertToWorldSpaceAR(cc.v3(0,150,0)),n=this._currSlot.convertToNodeSpaceAR(o);e.setParent(this._currSlot),this._currScrowNode.setPosition(n);var r=cc.v3(0,150,0),c=n.sub(r).mag()/1e3;this._isPlay_ScrewTween=!0,cc.tween(e).to(Math.min(c,.4),{position:r},{easing:"smooth"}).call(function(){t._isPlay_ScrewTween=!1,t.resetSrow(e),t._currScrowNode=null,t.ckeckLoop()}).start()},t.prototype.checkOvlerp=function(e){for(var t=!0,o=[],n=-1,r=0;r<this._platesArr.length;r++){var i=this._platesArr[r],s=i.getBoundingBox(),l=cc.director.getPhysicsManager().testPoint(cc.v2(this.node.convertToWorldSpaceAR(e.position)));if(null!=l&&console.log(l.node.name),s.contains(cc.v2(e.position))){n++,o.push(!1);var a=c.default.getConf(i.name);console.log("check",i.name,a);for(var p=0;p<a.slotCount;p++){var u=a.slotPoint[p],d=i.convertToWorldSpaceAR(u),h=this.node.convertToNodeSpaceAR(d);this._currSlot.position.sub(h).mag()<c.default.SucceDist?(console.log(e.name,"ovlerp",i.name,"'s slot",p),o[n]=!0,this._ovlerps.push({slot:e,plate:i,index:p})):console.error(e.name,"be blocked",i.name,p);var f=cc.director.getPhysicsManager().testPoint(cc.v2(this.node.convertToWorldSpaceAR(e.position)));null==f?o[n]=!0:console.log(f.node.name)}}}for(r=0;r<o.length;r++)0==o[r]&&(t=!1);return t},t.prototype.ckeckLoop=function(){console.warn("start check loop"),console.log(this._ovlerps);for(var e=0;e<this._ovlerps.length;e++){var t=this._ovlerps[e],o=t.slot.addComponent(cc.RevoluteJoint);o.connectedBody=t.plate.getComponent(cc.RigidBody),o.connectedAnchor=c.default.getConf(t.plate.name).slotPoint[t.index],o.collideConnected=!1,console.log(t.slot.name,"add joint",t.plate.name)}for(e=0;e<this._slotArr.length;e++){var n=this._slotArr[e],r=n.getComponents(cc.RevoluteJoint);if(0==n.childrenCount){n.getComponent(cc.PhysicsCircleCollider).enabled=!1;for(var i=0;i<r.length;i++)n.removeComponent(r[i]);console.log(n.name,"remove all joint")}else n.getComponent(cc.PhysicsCircleCollider).enabled=!0}this._ovlerps=[]},t.prototype.replay=function(){0==c.default.ReplayCount?(cc.director.loadScene("main"),c.default.ReplayCount++,c.default.FirstTouch=!0):this.openStore()},t.prototype.openStore=function(){FbPlayableAd.onCTAClick()},r([l(cc.Node)],t.prototype,"slotRootNode",void 0),r([l(cc.Node)],t.prototype,"platesRootNode",void 0),r([l(cc.Node)],t.prototype,"replayBtnNode",void 0),r([l(cc.SpriteFrame)],t.prototype,"screw_idle_sprite",void 0),r([l(cc.SpriteFrame)],t.prototype,"screw_select_sprite",void 0),r([l(cc.Node)],t.prototype,"handNode",void 0),t=r([s],t)}(cc.Component);o.default=a,cc._RF.pop()},{"./GameConfig":"GameConfig"}],LevelCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"477b49tQGxH6rTymiwOOhry","LevelCtrl");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,c=arguments.length,i=c<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(c<3?r(i):c>3?r(t,o,i):r(t,o))||i);return c>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,i=c.ccclass,s=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.content=this.node.getChildByName("content");for(var e=function(e){t.content.children[e].on(cc.Node.EventType.TOUCH_START,function(){var t=e+1,o="level"+(t<10?"0"+t:t);cc.director.loadScene(o)})},t=this,o=0;o<this.content.childrenCount;o++)e(o)},t=r([i],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],Utiltis:[function(e,t,o){"use strict";cc._RF.push(t,"4d803oygwpCSZCj10U70Nez","Utiltis"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"graphics",{get:function(){if(null==this._graphics){var e=new cc.Node;e.setParent(cc.director.getScene().getChildByName("Canvas")),this._graphics=e.addComponent(cc.Graphics)}return this._graphics},enumerable:!0,configurable:!0}),e.circle=function(t,o,n){void 0===n&&(n=cc.Color.WHITE),0!=e.GraphicsEnable&&(this.graphics.fillColor=n,this.graphics.circle(t.x,t.y,o),this.graphics.fill())},e.GraphicsEnable=!0,e}();o.default=n,cc._RF.pop()},{}]},{},["GameConfig","GameManager","LevelCtrl","Utiltis"]);